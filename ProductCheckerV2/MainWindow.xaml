<Window x:Class="ProductCheckerV2.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:ProductCheckerV2"
        mc:Ignorable="d"
        Title="Product Checker V2" 
        Height="850" 
        Width="1400"
        MinHeight="700"
        MinWidth="1200"
        WindowStartupLocation="CenterScreen"
        Background="#F8FAFC"
        WindowStyle="SingleBorderWindow"
        ResizeMode="CanResizeWithGrip">

    <Window.Resources>
        <!-- Enhanced Color Palette -->
        <SolidColorBrush x:Key="PrimaryBrush" Color="#3B82F6"/>
        <SolidColorBrush x:Key="PrimaryLightBrush" Color="#60A5FA"/>
        <SolidColorBrush x:Key="PrimaryDarkBrush" Color="#1D4ED8"/>
        <SolidColorBrush x:Key="SecondaryBrush" Color="#8B5CF6"/>
        <SolidColorBrush x:Key="SuccessBrush" Color="#10B981"/>
        <SolidColorBrush x:Key="SuccessLightBrush" Color="#34D399"/>
        <SolidColorBrush x:Key="WarningBrush" Color="#F59E0B"/>
        <SolidColorBrush x:Key="DangerBrush" Color="#EF4444"/>
        <SolidColorBrush x:Key="BackgroundBrush" Color="#F8FAFC"/>
        <SolidColorBrush x:Key="CardBrush" Color="#FFFFFF"/>
        <SolidColorBrush x:Key="SidebarBrush" Color="#1E293B"/>
        <SolidColorBrush x:Key="TextPrimaryBrush" Color="#0F172A"/>
        <SolidColorBrush x:Key="TextSecondaryBrush" Color="#64748B"/>
        <SolidColorBrush x:Key="TextLightBrush" Color="#94A3B8"/>
        <SolidColorBrush x:Key="BorderBrush" Color="#E2E8F0"/>
        <SolidColorBrush x:Key="BorderLightBrush" Color="#F1F5F9"/>
        <SolidColorBrush x:Key="HoverBrush" Color="#F1F5F9"/>
        <SolidColorBrush x:Key="SelectedBrush" Color="#EFF6FF"/>

        <!-- Modal Colors -->
        <SolidColorBrush x:Key="ModalOverlayBrush" Color="#99000000"/>
        <SolidColorBrush x:Key="ModalBackgroundBrush" Color="#FFFFFF"/>
        <SolidColorBrush x:Key="InfoModalHeaderBrush" Color="#3B82F6"/>
        <SolidColorBrush x:Key="SuccessModalHeaderBrush" Color="#10B981"/>
        <SolidColorBrush x:Key="WarningModalHeaderBrush" Color="#F59E0B"/>
        <SolidColorBrush x:Key="ErrorModalHeaderBrush" Color="#EF4444"/>

        <!-- Typography -->
        <FontFamily x:Key="AppFont">Segoe UI, -apple-system, BlinkMacSystemFont, sans-serif</FontFamily>

        <!-- Modern Card Style -->
        <Style x:Key="ModernCard" TargetType="Border">
            <Setter Property="Background" Value="{StaticResource CardBrush}"/>
            <Setter Property="CornerRadius" Value="16"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="24"/>
            <Setter Property="Margin" Value="0,0,0,20"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect BlurRadius="20" 
                                    ShadowDepth="0" 
                                    Opacity="0.08" 
                                    Color="#000000"
                                    Direction="270"
                                    RenderingBias="Performance"/>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Flat Card Style -->
        <Style x:Key="FlatCard" TargetType="Border">
            <Setter Property="Background" Value="{StaticResource CardBrush}"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="20"/>
            <Setter Property="Margin" Value="0,0,0,16"/>
        </Style>

        <!-- Modern Button Style -->
        <Style TargetType="Button">
            <Setter Property="FontFamily" Value="{StaticResource AppFont}"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="Normal"/>
            <Setter Property="Padding" Value="20,12"/>
            <Setter Property="Margin" Value="0,0,10,0"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Grid>
                            <Border x:Name="border" 
                                    Background="{TemplateBinding Background}"
                                    CornerRadius="10"
                                    BorderThickness="0">
                                <ContentPresenter HorizontalAlignment="Center" 
                                                VerticalAlignment="Center"
                                                Margin="{TemplateBinding Padding}"/>
                            </Border>
                            <Border x:Name="hoverOverlay" 
                                    Background="White" 
                                    CornerRadius="10"
                                    Opacity="0"/>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Opacity" Value="0.95"/>
                                <Setter TargetName="hoverOverlay" Property="Opacity" Value="0.1"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Opacity" Value="0.9"/>
                                <Setter TargetName="hoverOverlay" Property="Opacity" Value="0.15"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="border" Property="Opacity" Value="0.5"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Primary Button Style -->
        <Style x:Key="PrimaryButton" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
            <Setter Property="Background" Value="{StaticResource PrimaryBrush}"/>
            <Setter Property="Foreground" Value="White"/>
        </Style>

        <!-- Secondary Button Style -->
        <Style x:Key="SecondaryButton" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
            <Setter Property="Background" Value="{StaticResource BorderBrush}"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
        </Style>

        <!-- Success Button Style -->
        <Style x:Key="SuccessButton" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
            <Setter Property="Background" Value="{StaticResource SuccessBrush}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="24,14"/>
            <Setter Property="FontSize" Value="15"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
        </Style>

        <!-- Modal Button Style -->
        <Style x:Key="ModalButton" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
            <Setter Property="MinWidth" Value="80"/>
            <Setter Property="Height" Value="36"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Padding" Value="16,8"/>
        </Style>

        <!-- Success Modal Button -->
        <Style x:Key="SuccessModalButton" TargetType="Button" BasedOn="{StaticResource ModalButton}">
            <Setter Property="Background" Value="{StaticResource SuccessBrush}"/>
            <Setter Property="Foreground" Value="White"/>
        </Style>

        <!-- Warning Modal Button -->
        <Style x:Key="WarningModalButton" TargetType="Button" BasedOn="{StaticResource ModalButton}">
            <Setter Property="Background" Value="{StaticResource WarningBrush}"/>
            <Setter Property="Foreground" Value="White"/>
        </Style>

        <!-- Info Modal Button -->
        <Style x:Key="InfoModalButton" TargetType="Button" BasedOn="{StaticResource ModalButton}">
            <Setter Property="Background" Value="{StaticResource PrimaryBrush}"/>
            <Setter Property="Foreground" Value="White"/>
        </Style>

        <!-- Secondary Modal Button -->
        <Style x:Key="SecondaryModalButton" TargetType="Button" BasedOn="{StaticResource ModalButton}">
            <Setter Property="Background" Value="{StaticResource BorderBrush}"/>
            <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
        </Style>

        <!-- DataGrid Style -->
        <Style x:Key="ModernDataGrid" TargetType="DataGrid">
            <Setter Property="FontFamily" Value="{StaticResource AppFont}"/>
            <Setter Property="FontSize" Value="13.5"/>
            <Setter Property="AutoGenerateColumns" Value="False"/>
            <Setter Property="IsReadOnly" Value="True"/>
            <Setter Property="CanUserAddRows" Value="False"/>
            <Setter Property="CanUserDeleteRows" Value="False"/>
            <Setter Property="SelectionMode" Value="Single"/>
            <Setter Property="SelectionUnit" Value="FullRow"/>
            <Setter Property="GridLinesVisibility" Value="None"/>
            <Setter Property="RowHeaderWidth" Value="0"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="RowBackground" Value="Transparent"/>
            <Setter Property="AlternatingRowBackground" Value="{StaticResource HoverBrush}"/>
            <Setter Property="HeadersVisibility" Value="Column"/>
            <Setter Property="ScrollViewer.CanContentScroll" Value="True"/>
            <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto"/>
            <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Auto"/>
            <Setter Property="RowHeight" Value="44"/>
            <Setter Property="CellStyle">
                <Setter.Value>
                    <Style TargetType="DataGridCell">
                        <Setter Property="Padding" Value="16,10"/>
                        <Setter Property="BorderThickness" Value="0"/>
                        <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
                        <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
                        <Style.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="Background" Value="{StaticResource SelectedBrush}"/>
                                <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
                                <Setter Property="BorderBrush" Value="{StaticResource PrimaryBrush}"/>
                                <Setter Property="BorderThickness" Value="0,0,0,2"/>
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </Setter.Value>
            </Setter>
            <Setter Property="ColumnHeaderStyle">
                <Setter.Value>
                    <Style TargetType="DataGridColumnHeader">
                        <Setter Property="Background" Value="{StaticResource BorderLightBrush}"/>
                        <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
                        <Setter Property="FontWeight" Value="Bold"/>
                        <Setter Property="FontSize" Value="12.5"/>
                        <Setter Property="Padding" Value="16,14"/>
                        <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}"/>
                        <Setter Property="BorderThickness" Value="0,0,0,1"/>
                        <Setter Property="HorizontalContentAlignment" Value="Left"/>
                        <Setter Property="TextBlock.TextTrimming" Value="CharacterEllipsis"/>
                    </Style>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Header Text Style -->
        <Style x:Key="SectionHeader" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="{StaticResource AppFont}"/>
            <Setter Property="FontSize" Value="20"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
            <Setter Property="Margin" Value="0,0,0,20"/>
        </Style>

        <!-- SubHeader Text Style -->
        <Style x:Key="SubHeader" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="{StaticResource AppFont}"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
            <Setter Property="Margin" Value="0,0,0,12"/>
        </Style>

        <!-- Body Text Style -->
        <Style x:Key="BodyText" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="{StaticResource AppFont}"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
            <Setter Property="TextWrapping" Value="Wrap"/>
        </Style>

        <!-- Status Indicator -->
        <Style x:Key="StatusIndicator" TargetType="Border">
            <Setter Property="Width" Value="12"/>
            <Setter Property="Height" Value="12"/>
            <Setter Property="CornerRadius" Value="6"/>
            <Setter Property="Margin" Value="0,0,10,0"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>

        <!-- Progress Ring Style -->
        <Style x:Key="ProgressRingStyle" TargetType="Ellipse">
            <Setter Property="Width" Value="60"/>
            <Setter Property="Height" Value="60"/>
            <Setter Property="StrokeThickness" Value="4"/>
            <Setter Property="Stroke" Value="{StaticResource BorderBrush}"/>
        </Style>
    </Window.Resources>

    <Grid>
        <!-- Modal Overlay - Hidden by default -->
        <Border x:Name="ModalOverlay"
                Background="{StaticResource ModalOverlayBrush}"
                Visibility="Collapsed"
                Panel.ZIndex="1000">
            <Border.Triggers>
                <EventTrigger RoutedEvent="Loaded">
                    <BeginStoryboard>
                        <Storyboard>
                            <DoubleAnimation Storyboard.TargetProperty="Opacity"
                                             From="0" To="1"
                                             Duration="0:0:0.2"/>
                        </Storyboard>
                    </BeginStoryboard>
                </EventTrigger>
            </Border.Triggers>
        </Border>

        <!-- Confirm Processing Modal -->
        <Border x:Name="ConfirmProcessingModal"
                Width="500"
                Height="400"
                Background="{StaticResource ModalBackgroundBrush}"
                CornerRadius="16"
                Panel.ZIndex="1001"
                Visibility="Collapsed"
                HorizontalAlignment="Center"
                VerticalAlignment="Center">
            <Border.Effect>
                <DropShadowEffect BlurRadius="30" 
                                ShadowDepth="0" 
                                Opacity="0.2" 
                                Color="#000000"/>
            </Border.Effect>
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="80"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="80"/>
                </Grid.RowDefinitions>

                <!-- Modal Header -->
                <Border Grid.Row="0"
                        Background="{StaticResource InfoModalHeaderBrush}"
                        CornerRadius="16,16,0,0">
                    <StackPanel Orientation="Horizontal"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center">
                        <TextBlock Text="🚀"
                                   FontSize="20"
                                   Margin="0,0,15,0"/>
                        <TextBlock Text="Submit Request"
                                   FontSize="22"
                                   FontWeight="SemiBold"
                                   Foreground="White"/>
                    </StackPanel>
                </Border>

                <!-- Modal Content -->
                <StackPanel Grid.Row="1"
                            Margin="30"
                            VerticalAlignment="Center">

                    <!-- Warning Message -->
                    <Border Background="#FEF3C7"
                            CornerRadius="8"
                            Padding="15"
                            BorderThickness="1"
                            BorderBrush="#F59E0B"
                            Margin="0,0,0,20">
                        <StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                <TextBlock Text="⚠️"
                                           FontSize="16"
                                           Margin="0,0,10,0"/>
                                <TextBlock Text="Important Notice"
                                           FontSize="19"
                                           FontWeight="SemiBold"
                                           Foreground="#92400E"/>
                            </StackPanel>
                            <TextBlock Text="This will create a new queued request. Processing may take a few minutes, depending on the number of records."
                                       FontSize="18"
                                       Foreground="#92400E"
                                       TextWrapping="Wrap"/>
                        </StackPanel>
                    </Border>

                    <TextBlock Text="Are you sure you want to submit this request?"
                               FontSize="15"
                               FontWeight="Medium"
                               Foreground="{StaticResource TextPrimaryBrush}"
                               TextWrapping="Wrap"/>
                </StackPanel>

                <!-- Modal Footer -->
                <Border Grid.Row="2"
                        Background="#F7FAFC"
                        CornerRadius="0,0,16,16"
                        Padding="20">
                    <StackPanel Orientation="Horizontal"
                                HorizontalAlignment="Right">
                        <Button x:Name="CancelProcessingButton"
                                Content="Cancel"
                                Style="{StaticResource SecondaryModalButton}"
                                Click="CancelProcessingButton_Click"/>
                        <Button x:Name="ConfirmProcessingButton"
                                Content="Submit Request"
                                Style="{StaticResource SuccessModalButton}"
                                Click="ConfirmProcessingButton_Click"
                                Margin="10,0,0,0"/>
                    </StackPanel>
                </Border>
            </Grid>
        </Border>

        <!-- Success Modal -->
        <Border x:Name="SuccessModal"
                Width="450"
                Height="360"
                Background="{StaticResource ModalBackgroundBrush}"
                CornerRadius="16"
                Panel.ZIndex="1001"
                Visibility="Collapsed"
                HorizontalAlignment="Center"
                VerticalAlignment="Center">
            <Border.Effect>
                <DropShadowEffect BlurRadius="30" 
                                ShadowDepth="0" 
                                Opacity="0.2" 
                                Color="#000000"/>
            </Border.Effect>
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="80"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="80"/>
                </Grid.RowDefinitions>

                <!-- Modal Header -->
                <Border Grid.Row="0"
                        Background="{StaticResource SuccessModalHeaderBrush}"
                        CornerRadius="16,16,0,0">
                    <StackPanel Orientation="Horizontal"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center">
                        <TextBlock Text="✅"
                                   FontSize="28"
                                   Margin="0,0,15,0"/>
                        <TextBlock Text="Request Complete"
                                   FontSize="22"
                                   FontWeight="SemiBold"
                                   Foreground="White"/>
                    </StackPanel>
                </Border>

                <!-- Modal Content -->
                <StackPanel Grid.Row="1"
                            Margin="30"
                            VerticalAlignment="Center">
                    <Grid Width="72" Height="72" Margin="0,0,0,20" HorizontalAlignment="Center">
                        <Ellipse Fill="#D1FAE5"/>
                        <TextBlock Text="🎉"
                                   FontSize="28"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center"/>
                    </Grid>

                    <TextBlock x:Name="SuccessRequestId"
                               Text="Request #0 created"
                               FontSize="18"
                               FontWeight="Bold"
                               Foreground="#10B981"
                               HorizontalAlignment="Center"
                               Margin="0,0,0,10"/>

                    <TextBlock x:Name="SuccessRecordCount"
                               Text="0 records processed"
                               FontSize="15"
                               Foreground="{StaticResource TextSecondaryBrush}"
                               HorizontalAlignment="Center"
                               Margin="0,0,0,20"/>

                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                        <TextBlock Text="👤"
                                   FontSize="14"
                                   Margin="0,0,5,0"/>
                        <TextBlock x:Name="SuccessUserName"
                                   Text="User"
                                   FontSize="14"
                                   Foreground="{StaticResource TextSecondaryBrush}"/>
                        <TextBlock Text=" • "
                                   FontSize="14"
                                   Foreground="{StaticResource TextSecondaryBrush}"
                                   Margin="5,0,5,0"/>
                        <TextBlock x:Name="SuccessTimestamp"
                                   Text="Just now"
                                   FontSize="14"
                                   Foreground="{StaticResource TextSecondaryBrush}"/>
                    </StackPanel>
                </StackPanel>

                <!-- Modal Footer -->
                <Border Grid.Row="2"
                        Background="#F7FAFC"
                        CornerRadius="0,0,16,16"
                        Padding="20">
                    <StackPanel Orientation="Horizontal"
                                HorizontalAlignment="Center">
                        <Button x:Name="NewRequestButton"
                                Content="Start New Request"
                                Style="{StaticResource SuccessModalButton}"
                                Click="NewRequestButton_Click"
                                Width="140"/>
                        <Button x:Name="ViewRequestsSuccessButton"
                                Content="View Requests"
                                Style="{StaticResource InfoModalButton}"
                                Click="ViewRequestsSuccessButton_Click"
                                Margin="10,0,0,0"
                                Width="120"/>
                    </StackPanel>
                </Border>
            </Grid>
        </Border>

        <!-- Error Modal -->
        <Border x:Name="ErrorModal"
                Width="500"
                Height="320"
                Background="{StaticResource ModalBackgroundBrush}"
                CornerRadius="16"
                Panel.ZIndex="1001"
                Visibility="Collapsed"
                HorizontalAlignment="Center"
                VerticalAlignment="Center">
            <Border.Effect>
                <DropShadowEffect BlurRadius="30" 
                                ShadowDepth="0" 
                                Opacity="0.2" 
                                Color="#000000"/>
            </Border.Effect>
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="80"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="80"/>
                </Grid.RowDefinitions>

                <!-- Modal Header -->
                <Border Grid.Row="0"
                        Background="{StaticResource ErrorModalHeaderBrush}"
                        CornerRadius="16,16,0,0">
                    <StackPanel Orientation="Horizontal"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center">
                        <TextBlock Text="❌"
                                   FontSize="28"
                                   Margin="0,0,15,0"/>
                        <TextBlock Text="Processing Error"
                                   FontSize="22"
                                   FontWeight="SemiBold"
                                   Foreground="White"/>
                    </StackPanel>
                </Border>

                <!-- Modal Content -->
                <StackPanel Grid.Row="1"
                            Margin="30"
                            VerticalAlignment="Center">
                    <Grid Width="64" Height="64" Margin="0,0,0,15" HorizontalAlignment="Center">
                        <Ellipse Fill="#FEE2E2"/>
                        <TextBlock Text="⚠️"
                                   FontSize="24"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center"/>
                    </Grid>

                    <TextBlock x:Name="ErrorMessage"
                               Text="An error occurred while processing the request."
                               FontSize="15"
                               FontWeight="Medium"
                               Foreground="#0F172A"
                               TextWrapping="Wrap"
                               TextAlignment="Center"
                               Margin="0,0,0,10"/>

                    <Border Background="#FEE2E2"
                            CornerRadius="8"
                            Padding="12"
                            MaxHeight="80">
                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                            <TextBlock x:Name="ErrorDetails"
                                       Text=""
                                       FontSize="12"
                                       Foreground="#991B1B"
                                       TextWrapping="Wrap"
                                       FontFamily="Consolas"/>
                        </ScrollViewer>
                    </Border>
                </StackPanel>

                <!-- Modal Footer -->
                <Border Grid.Row="2"
                        Background="#F7FAFC"
                        CornerRadius="0,0,16,16"
                        Padding="20">
                    <StackPanel Orientation="Horizontal"
                                HorizontalAlignment="Right">
                        <Button x:Name="CloseErrorButton"
                                Content="OK"
                                Style="{StaticResource InfoModalButton}"
                                Click="CloseErrorButton_Click"
                                Width="80"/>
                    </StackPanel>
                </Border>
            </Grid>
        </Border>

        <!-- Main Content -->
        <Grid>
            <!-- App Header -->
            <Border Background="{StaticResource CardBrush}"
                    BorderBrush="{StaticResource BorderBrush}"
                    BorderThickness="0,0,0,1"
                    Padding="30,20"
                    Height="95"
                    VerticalAlignment="Top">
                <Grid>
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                        <Image x:Name="LogoImage" Height="50" Width="50" Margin="0,0,10,0" RenderTransformOrigin="0.5,0.5">
                            <Image.RenderTransform>
                                <TransformGroup>
                                    <ScaleTransform x:Name="LogoScaleTransform" />
                                </TransformGroup>
                            </Image.RenderTransform>
                        </Image>
                        <StackPanel VerticalAlignment="Center">
                            <TextBlock Text="PRODUCT CHECKER" 
                                     FontSize="30" 
                                     FontWeight="Bold" 
                                     Foreground="{StaticResource TextPrimaryBrush}"/>
                        </StackPanel>
                    </StackPanel>

                    <!-- View Requests Button -->
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center">
                        <Button x:Name="ViewRequestsButton"
                                Content="View All Product Checker Requests"
                                Style="{StaticResource PrimaryButton}"
                                Click="ViewRequestsButton_Click"
                                Width="254"
                                Margin="0,0,0,0"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Main Content -->
            <Grid Margin="30,120,30,10">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="420"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Left Panel: Upload Section -->
                <StackPanel Grid.Column="0" Margin="0,0,20,20">
                    <!-- Upload Card -->
                    <Border Style="{StaticResource ModernCard}" Height="660">
                        <StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                                <Grid Width="32" Height="32" Margin="0,0,12,0">
                                    <Ellipse Fill="{StaticResource PrimaryBrush}" Opacity="0.1"/>
                                    <TextBlock Text="📤" 
                                             FontSize="16" 
                                             HorizontalAlignment="Center"
                                             VerticalAlignment="Center"/>
                                </Grid>
                                <TextBlock Style="{StaticResource SectionHeader}" Text="File Upload" Margin="0"/>
                            </StackPanel>

                            <!-- Drag & Drop Area -->
                            <Border x:Name="UploadArea" 
                                    Background="{StaticResource HoverBrush}"
                                    BorderBrush="{StaticResource BorderBrush}"
                                    BorderThickness="2"
                                    CornerRadius="12"
                                    Padding="40,35"
                                    Margin="0,0,0,20"
                                    Cursor="Hand">
                                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                    <Grid Width="72" Height="72" Margin="0,0,0,20">
                                        <Ellipse Fill="{StaticResource PrimaryBrush}" Opacity="0.08"/>
                                        <TextBlock Text="📁" 
                                                 FontSize="32" 
                                                 HorizontalAlignment="Center"
                                                 VerticalAlignment="Center"/>
                                    </Grid>
                                    <TextBlock Text="Drag &amp; Drop Excel File" 
                                             FontSize="15" 
                                             FontWeight="Bold"
                                             Foreground="{StaticResource TextPrimaryBrush}"
                                             HorizontalAlignment="Center"
                                             Margin="0,0,0,8"/>
                                    <TextBlock Text=".xlsx, .xls, .xlsm formats supported" 
                                             FontSize="13"
                                             Foreground="{StaticResource TextLightBrush}"
                                             HorizontalAlignment="Center"
                                             Margin="0,0,0,16"/>
                                    <Button x:Name="BrowseButton" 
                                            Content="Browse Files"
                                            Style="{StaticResource PrimaryButton}"
                                            Click="BrowseButton_Click"
                                            Width="140"/>
                                </StackPanel>
                            </Border>

                            <!-- File Info Card -->
                            <Border Style="{StaticResource FlatCard}">
                                <StackPanel>
                                    <TextBlock Style="{StaticResource SubHeader}" Text="File Information"/>

                                    <!-- Selected File -->
                                    <StackPanel Margin="0,0,0,16">
                                        <TextBlock Text="Selected File" 
                                                 FontSize="12.5"
                                                 FontWeight="Bold"
                                                 Foreground="{StaticResource TextLightBrush}"
                                                 Margin="0,0,0,6"/>
                                        <Grid>
                                            <Border Background="{StaticResource BorderLightBrush}" 
                                                    CornerRadius="8"
                                                    Padding="14">
                                                <TextBlock x:Name="FilePathText" 
                                                         Text="No file selected"
                                                         FontSize="13.5"
                                                         Foreground="{StaticResource TextSecondaryBrush}"
                                                         TextTrimming="CharacterEllipsis"/>
                                            </Border>
                                            <Button x:Name="ClearButton" 
                                                    Content="Clear"
                                                    Style="{StaticResource SecondaryButton}"
                                                    HorizontalAlignment="Right"
                                                    Width="80"
                                                    Click="ClearButton_Click"
                                                    Margin="5"/>
                                        </Grid>
                                    </StackPanel>

                                    <!-- File Details -->
                                    <ItemsControl x:Name="FileInfoItems">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                                    <Border Style="{StaticResource StatusIndicator}" 
                                                            Background="{Binding Color}"/>
                                                    <TextBlock Text="{Binding Text}" 
                                                             FontSize="13"
                                                             Foreground="{StaticResource TextSecondaryBrush}"
                                                             VerticalAlignment="Center"/>
                                                </StackPanel>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </Border>
                </StackPanel>

                <!-- Right Panel: Data Preview -->
                <Border Grid.Column="1" Style="{StaticResource ModernCard}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Preview Header with Action Button -->
                        <Grid Grid.Row="0" Margin="0,0,0,20">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <!-- Left side: Title and stats -->
                            <StackPanel Grid.Column="0">
                                <StackPanel Orientation="Horizontal">
                                    <Grid Width="32" Height="32" Margin="0,0,12,0">
                                        <Ellipse Fill="{StaticResource SuccessBrush}" Opacity="0.1"/>
                                        <TextBlock Text="📊" 
                                                 FontSize="16" 
                                                 HorizontalAlignment="Center"
                                                 VerticalAlignment="Center"/>
                                    </Grid>
                                    <TextBlock Style="{StaticResource SectionHeader}" Text="Data Preview" Margin="0"/>
                                </StackPanel>
                                <TextBlock x:Name="RecordCountText" 
                                         Text="0 records loaded"
                                         FontSize="14"
                                         Foreground="{StaticResource TextLightBrush}"
                                         Margin="44,0,0,0"/>
                            </StackPanel>

                            <!-- Right side: Submit Request Button -->
                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                <Button x:Name="StartButton" 
                                        Content="🚀 Submit Request"
                                        Style="{StaticResource SuccessButton}"
                                        Click="StartButton_Click"
                                        Width="200"
                                        Height="50"
                                        IsEnabled="False">
                                    <Button.Effect>
                                        <DropShadowEffect BlurRadius="15" 
                                            ShadowDepth="0" 
                                            Opacity="0.15" 
                                            Color="#10B981"/>
                                    </Button.Effect>
                                </Button>
                            </StackPanel>
                        </Grid>

                        <!-- Data Grid Container -->
                        <Border Grid.Row="1" 
                                Background="White"
                                BorderBrush="{StaticResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="12"
                                Margin="0,0,0,20">
                            <Grid>
                                <!-- Empty State -->
                                <Border x:Name="EmptyState" 
                                        Visibility="Visible"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        Padding="40">
                                    <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                        <Grid Width="64" Height="64" Margin="0,0,0,20">
                                            <Ellipse Fill="{StaticResource BorderLightBrush}"/>
                                            <TextBlock Text="📁" 
                                                     FontSize="24" 
                                                     HorizontalAlignment="Center"
                                                     VerticalAlignment="Center"/>
                                        </Grid>
                                        <TextBlock Text="No Data Loaded" 
                                                 FontSize="16" 
                                                 FontWeight="Bold"
                                                 Foreground="{StaticResource TextSecondaryBrush}"
                                                 HorizontalAlignment="Center"
                                                 Margin="0,0,0,8"/>
                                        <TextBlock Text="Upload an Excel file to preview data" 
                                                 FontSize="14"
                                                 Foreground="{StaticResource TextLightBrush}"
                                                 HorizontalAlignment="Center"/>
                                    </StackPanel>
                                </Border>

                                <!-- Data Grid -->
                                <DataGrid x:Name="DataGridPreview" 
                                        Style="{StaticResource ModernDataGrid}"
                                        AutoGeneratingColumn="DataGrid_AutoGeneratingColumn"
                                        Visibility="Collapsed">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Listing ID" 
                                                          Binding="{Binding ListingId}" 
                                                          Width="160"/>
                                        <DataGridTextColumn Header="Case Number" 
                                                          Binding="{Binding CaseNumber}" 
                                                          Width="160"/>
                                        <DataGridTextColumn Header="Platform" 
                                                          Binding="{Binding Platform}" 
                                                          Width="140">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="HorizontalAlignment" Value="Left"/>
                                                    <Setter Property="VerticalAlignment" Value="Center"/>
                                                    <Setter Property="Padding" Value="8,4"/>
                                                    <Setter Property="FontWeight" Value="Normal"/>
                                                    <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
                                                    <Style.Triggers>
                                                        <Trigger Property="Text" Value="AMAZON">
                                                            <Setter Property="Background" Value="#FFEBF3FF"/>
                                                            <Setter Property="Foreground" Value="#1D4ED8"/>
                                                        </Trigger>
                                                        <Trigger Property="Text" Value="EBAY">
                                                            <Setter Property="Background" Value="#FFF5F3FF"/>
                                                            <Setter Property="Foreground" Value="#7C3AED"/>
                                                        </Trigger>
                                                        <Trigger Property="Text" Value="WALMART">
                                                            <Setter Property="Background" Value="#FFF0FDF4"/>
                                                            <Setter Property="Foreground" Value="#047857"/>
                                                        </Trigger>
                                                        <Trigger Property="Text" Value="TARGET">
                                                            <Setter Property="Background" Value="#FFFEF3C7"/>
                                                            <Setter Property="Foreground" Value="#92400E"/>
                                                        </Trigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>
                                        <DataGridTextColumn Header="Product URL" 
                                                          Binding="{Binding ProductUrl}" 
                                                          Width="*">
                                            <DataGridTextColumn.ElementStyle>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="TextTrimming" Value="CharacterEllipsis"/>
                                                    <Setter Property="Foreground" Value="{StaticResource PrimaryBrush}"/>
                                                    <Setter Property="Cursor" Value="Hand"/>
                                                    <Setter Property="TextDecorations" Value="Underline"/>
                                                </Style>
                                            </DataGridTextColumn.ElementStyle>
                                        </DataGridTextColumn>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Grid>
                        </Border>
                    </Grid>
                </Border>
            </Grid>

            <!-- Progress Overlay -->
            <Grid x:Name="ProgressOverlay" 
                  Background="#80000000" 
                  Visibility="Collapsed"
                  Panel.ZIndex="1000">
                <Border Background="{StaticResource CardBrush}" 
                        CornerRadius="20" 
                        Padding="50" 
                        Width="460" 
                        Height="280"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center">
                    <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                        <!-- Animated Progress Ring -->
                        <Grid Width="80" Height="80" Margin="0,0,0,30">
                            <Ellipse Style="{StaticResource ProgressRingStyle}"/>
                            <Ellipse Style="{StaticResource ProgressRingStyle}" 
                                     Stroke="{StaticResource PrimaryBrush}"
                                     StrokeDashArray="0.1, 0.9"
                                     StrokeDashOffset="0">
                                <Ellipse.RenderTransform>
                                    <RotateTransform Angle="0"/>
                                </Ellipse.RenderTransform>
                                <Ellipse.Triggers>
                                    <EventTrigger RoutedEvent="Loaded">
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <DoubleAnimation Storyboard.TargetProperty="(Ellipse.RenderTransform).(RotateTransform.Angle)"
                                                               From="0" To="360" Duration="0:0:1"
                                                               RepeatBehavior="Forever"/>
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </EventTrigger>
                                </Ellipse.Triggers>
                            </Ellipse>
                            <TextBlock Text="⏳" 
                                     FontSize="24" 
                                     HorizontalAlignment="Center"
                                     VerticalAlignment="Center"/>
                        </Grid>

                        <TextBlock x:Name="ProgressText" 
                                 Text="Processing..." 
                                 HorizontalAlignment="Center"
                                 FontSize="18"
                                 FontWeight="Bold"
                                 Foreground="{StaticResource TextPrimaryBrush}"
                                 Margin="0,0,0,12"/>
                        <TextBlock x:Name="ProgressSubText" 
                                 Text="Creating database request..." 
                                 HorizontalAlignment="Center"
                                 FontSize="14"
                                 Foreground="{StaticResource TextSecondaryBrush}"
                                 TextWrapping="Wrap"
                                 TextAlignment="Center"
                                 MaxWidth="300"/>

                        <!-- Progress Bar -->
                        <ProgressBar x:Name="MainProgressBar"
                                   Value="0" 
                                   Height="6" 
                                   Width="300"
                                   Margin="0,20,0,0"
                                   Background="{StaticResource BorderBrush}"
                                   Foreground="{StaticResource PrimaryBrush}"/>
                    </StackPanel>
                </Border>
            </Grid>
        </Grid>
    </Grid>
</Window>